!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).SVGInjector={})}(this,(function(t){"use strict";function e(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}var r=new Map,n=function(t){return t.cloneNode(!0)},i=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,o=/\\([\u000b\u0020-\u00ff])/g,a=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,l=function(t){if(!t)throw new TypeError("argument string is required");var e="object"==typeof t?function(t){var e;"function"==typeof t.getHeader?e=t.getHeader("content-type"):"object"==typeof t.headers&&(e=t.headers&&t.headers["content-type"]);if("string"!=typeof e)throw new TypeError("content-type header is missing from object");return e}(t):t;if("string"!=typeof e)throw new TypeError("argument string is required to be a string");var r=e.indexOf(";"),n=-1!==r?e.substr(0,r).trim():e.trim();if(!a.test(n))throw new TypeError("invalid media type");var l=new s(n.toLowerCase());if(-1!==r){var u,c,f;for(i.lastIndex=r;c=i.exec(e);){if(c.index!==r)throw new TypeError("invalid parameter format");r+=c[0].length,u=c[1].toLowerCase(),'"'===(f=c[2])[0]&&(f=f.substr(1,f.length-2).replace(o,"$1")),l.parameters[u]=f}if(r!==e.length)throw new TypeError("invalid parameter format")}return l};function s(t){this.parameters=Object.create(null),this.type=t}var u=function(){return"file:"===window.location.protocol},c=function(t,e,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){try{if(!/\.svg/i.test(t)&&2===n.readyState){var e=n.getResponseHeader("Content-Type");if(!e)throw new Error("Content type not found");var i=l(e).type;if("image/svg+xml"!==i&&"text/plain"!==i)throw new Error("Invalid content type: ".concat(i))}if(4===n.readyState){if(404===n.status||null===n.responseXML)throw new Error(u()?"Note: SVG injection ajax calls do not work locally without adjusting security settings in your browser. Or consider using a local webserver.":"Unable to load SVG file: "+t);if(!(200===n.status||u()&&0===n.status))throw new Error("There was a problem injecting the SVG: "+n.status+" "+n.statusText);r(null,n)}}catch(t){if(n.abort(),!(t instanceof Error))throw t;r(t,n)}},n.open("GET",t),n.withCredentials=e,n.overrideMimeType&&n.overrideMimeType("text/xml"),n.send()},f={},d=function(t,e){f[t]=f[t]||[],f[t].push(e)},p=function(t,e,i){if(r.has(t)){var o=r.get(t);if(void 0===o)return void d(t,i);if(o instanceof SVGSVGElement)return void i(null,n(o))}r.set(t,void 0),d(t,i),c(t,e,(function(e,i){e?r.set(t,e):i.responseXML instanceof Document&&i.responseXML.documentElement&&i.responseXML.documentElement instanceof SVGSVGElement&&r.set(t,i.responseXML.documentElement),function(t){for(var e=function(e,i){setTimeout((function(){if(Array.isArray(f[t])){var i=r.get(t),o=f[t][e];i instanceof SVGSVGElement&&o(null,n(i)),i instanceof Error&&o(i),e===f[t].length-1&&delete f[t]}}),0)},i=0,o=f[t].length;i<o;i++)e(i)}(t)}))},h=function(t,e,r){c(t,e,(function(t,e){t?r(t):e.responseXML instanceof Document&&e.responseXML.documentElement&&e.responseXML.documentElement instanceof SVGSVGElement&&r(null,e.responseXML.documentElement)}))},v=0,g=[],m={},y="http://www.w3.org/1999/xlink",w=function(t,r,n,i,o,a,l){var s=t.getAttribute("data-src")||t.getAttribute("src");if(s){if(-1!==g.indexOf(t))return g.splice(g.indexOf(t),1),void(t=null);g.push(t),t.setAttribute("src",""),(i?p:h)(s,o,(function(i,o){if(!o)return g.splice(g.indexOf(t),1),t=null,void l(i);var u=t.getAttribute("id");u&&o.setAttribute("id",u);var c=t.getAttribute("title");c&&o.setAttribute("title",c);var f=t.getAttribute("width");f&&o.setAttribute("width",f);var d=t.getAttribute("height");d&&o.setAttribute("height",d);var p=Array.from(new Set(e(e(e([],(o.getAttribute("class")||"").split(" "),!0),["injected-svg"],!1),(t.getAttribute("class")||"").split(" "),!0))).join(" ").trim();o.setAttribute("class",p);var h=t.getAttribute("style");h&&o.setAttribute("style",h),o.setAttribute("data-src",s);var w=[].filter.call(t.attributes,(function(t){return/^data-\w[\w-]*$/.test(t.name)}));if(Array.prototype.forEach.call(w,(function(t){t.name&&t.value&&o.setAttribute(t.name,t.value)})),n){var b,A,E,x,S={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],path:[],pattern:["fill","stroke"],radialGradient:["fill","stroke"]};Object.keys(S).forEach((function(t){A=S[t];for(var e=function(t,e){var r;x=(E=b[t].id)+"-"+ ++v,Array.prototype.forEach.call(A,(function(t){for(var e=0,n=(r=o.querySelectorAll("["+t+'*="'+E+'"]')).length;e<n;e++){var i=r[e].getAttribute(t);i&&!i.match(new RegExp('url\\("?#'+E+'"?\\)'))||r[e].setAttribute(t,"url(#"+x+")")}}));for(var n=o.querySelectorAll("[*|href]"),i=[],a=0,l=n.length;a<l;a++){var s=n[a].getAttributeNS(y,"href");s&&s.toString()==="#"+b[t].id&&i.push(n[a])}for(var u=0,c=i.length;u<c;u++)i[u].setAttributeNS(y,"href","#"+x);b[t].id=x},r=0,n=(b=o.querySelectorAll(t+"[id]")).length;r<n;r++)e(r)}))}o.removeAttribute("xmlns:a");for(var j,G,T=o.querySelectorAll("script"),k=[],M=0,V=T.length;M<V;M++)(G=T[M].getAttribute("type"))&&"application/ecmascript"!==G&&"application/javascript"!==G&&"text/javascript"!==G||((j=T[M].innerText||T[M].textContent)&&k.push(j),o.removeChild(T[M]));if(k.length>0&&("always"===r||"once"===r&&!m[s])){for(var L=0,q=k.length;L<q;L++)new Function(k[L])(window);m[s]=!0}var C=o.querySelectorAll("style");if(Array.prototype.forEach.call(C,(function(t){t.textContent+=""})),o.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.setAttribute("xmlns:xlink",y),a(o),!t.parentNode)return g.splice(g.indexOf(t),1),t=null,void l(new Error("Parent node is null"));t.parentNode.replaceChild(o,t),g.splice(g.indexOf(t),1),t=null,l(null,o)}))}else l(new Error("Invalid data-src or src attribute"))};t.SVGInjector=function(t,e){var r=void 0===e?{}:e,n=r.afterAll,i=void 0===n?function(){}:n,o=r.afterEach,a=void 0===o?function(){}:o,l=r.beforeEach,s=void 0===l?function(){}:l,u=r.cacheRequests,c=void 0===u||u,f=r.evalScripts,d=void 0===f?"never":f,p=r.httpRequestWithCredentials,h=void 0!==p&&p,v=r.renumerateIRIElements,g=void 0===v||v;if(t&&"length"in t)for(var m=0,y=0,b=t.length;y<b;y++)w(t[y],d,g,c,h,s,(function(e,r){a(e,r),t&&"length"in t&&t.length===++m&&i(m)}));else t?w(t,d,g,c,h,s,(function(e,r){a(e,r),i(1),t=null})):i(0)}}));
//# sourceMappingURL=svg-injector.umd.production.js.map
